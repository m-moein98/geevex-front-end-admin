<nb-card class="screen-75 mx-auto shadow-sm border-0">
  <nb-card-header class="d-flex justify-content-between align-items-center text-white">
    <h6 class="mb-0">Select Similar Coins (max 3)</h6>
    <button
      nbButton
      ghost
      size="tiny"
      status="danger"
      (click)="closeDialog()"
      class="text-white"
    >
      âœ•
    </button>
  </nb-card-header>

  <nb-card-body class="p-3">
    <!-- Search -->
    <div class="input-group mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text">
          <nb-icon icon="search-outline"></nb-icon>
        </span>
      </div>
      <input
        nbInput
        fullWidth
        class="form-control"
        placeholder="Search coins by name or symbol..."
        [formControl]="searchControl"
      />
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="text-center py-4">
      <nb-spinner status="info"></nb-spinner>
      <p class="mt-2 text-muted small">Loading coins...</p>
    </div>

    <!-- Coin List -->
    <div *ngIf="!isLoading" class="list-group" style="max-height: 400px; overflow-y: auto;">
      <button
        type="button"
        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
        *ngFor="let coin of filteredCoins"
        [ngClass]="{ 'active': isSelected(coin) }"
        (click)="toggleSelection(coin)"
      >
        <div>
          <strong>{{ coin.name }}</strong>
        </div>
        <nb-icon
          *ngIf="isSelected(coin)"
          icon="checkmark-circle-2"
          status="success"
        ></nb-icon>
      </button>
    </div>

    <!-- Selected -->
    <div *ngIf="selectedCoins.length" class="mt-3">
      <label class="font-weight-bold">Selected:</label>
      <div>
        <span
          *ngFor="let c of selectedCoins"
          class="badge badge-primary mr-1 mb-1 p-2"
        >
          {{ c.symbol }}
        </span>
      </div>
    </div>
  </nb-card-body>

  <nb-card-footer class="d-flex justify-content-end">
    <button nbButton status="basic" class="mr-2" (click)="closeDialog()">Cancel</button>
    <button
      nbButton
      status="primary"
      [disabled]="isSubmitting"
      (click)="onSubmit()"
    >
      {{ isSubmitting ? 'Saving...' : 'Save' }}
    </button>
  </nb-card-footer>
</nb-card>
